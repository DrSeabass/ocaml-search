(**

   @author jtd7
   @since 2011-03-14
*)

let unit_grid_weights =
[1, [|5.62050406216483329e-16; 3.818134067002942;
      5.22701350671053611; 0.|];
 3, [|-4.09958525460209234e-15; -13.3087760545656657;
      -20.1474420541721315; 0.|];
 5, [|1.57296051184192822e-15; -9.47613606796950769;
      -17.9955917958505793; 0.|];
 10, [|-5.58147278395522398e-16; -5.897080540258961;
       -16.0212646323351642; 0.|];
 50, [|3.95617566484320301e-14; -2.13629074537342412;
       -13.4391619809916225;
   1.14622287356525291e-15|];
 100, [|-8.7839284457216874e-14; -1.45180020009956467;
	-12.7205338669342858; 1.16410787259795432e-15|];
 500, [|6.90816848170008679e-14; -0.58876697682178436;
	-11.9203926029682403; 1.90388828834046441e-15|];
 1000, [|-1.30898347716618794e-13; -0.416700043355007488;
	 -11.7281176221444117; -4.67634720009640754e-15|]]

let life_grid_weights =
[1,  [|0.00113248854631000317; -32.6109978331198178; 35.0647382222008659;
   -32.6113344267236158; -35.243032586053296; -3.07732691753001642e-05|];
 3,  [|-0.00256089601117016463; -15.9251574184698725; 18.4928724133818214;
   -25.523706369141042; -29.4737017673183423; -0.00497246222468625265|];
 5,  [|-0.00306136867369268; -12.9760843145302314; 15.5712079456738621;
   -22.9078581642033754; -26.6134976875592; -0.00516627028872268697|];
 10, [|-0.00744228938813642528; -9.19561812144011093; 11.5724312031125098;
   -21.8933685946247252; -25.1649467061958845; -0.0060132479966816272|]]


let fifteen_puzzle_weights =
[1,    [|0.; -164.571428571252852; -164.571428571252852; 0.|];
 3,    [|6.93889390390743743e-16; 16.4754285714233646; 12.8561904761883348;
	 0.|];
 5,    [|9.71445146547024e-16; -73.8286857142623347; -151.467580952413186;
	 0.|];
 10,   [|3.23339965912948941e-14; -55.2572571428581512; -149.255714285718113;
	 -4.4061976289775859e-15|];
 50,   [|-1.29058430609052797e-13; -33.029474285716347; -137.874731428555208;
	 2.0157486790840278e-14|];
 100,  [|1.77544090540452439e-14; -26.2042380952391447; -135.637041904773412;
	 4.06966127464314129e-14|];
 500,  [|-6.74451050563984322e-13; -18.0554521904784195; -119.529559619062368;
	 4.42007541679199555e-14|];
 1000, [|-7.55523421603052814e-14; -14.4691045714269659; -124.724240190460804;
	 4.40272818203386894e-14|]]

let inv_15_puzzle =
[5, [|-0.000199846860656902351; 0.000992343032155267295; -0.000999999999999993;
      -0.00490428790199123801; -0.00500000000000657904;
      0.00185528330781016939|];
 10, [|-0.0016895099540756328; 0.000674196018401044639;
       -0.000750000000000105725; -0.00297970903528318922;
       -0.00249999999999747907; 7.254977029775413e-05|];
 50, [|-0.00266068147013933613; -0.00215061255743509124;
       -0.00385000000000079419; -0.000171018376737026986;
       -0.00427500000000083889; 3.36906586179960355e-06|];
 100, [|-0.000766673047473595635; -0.00153074272589497767;
	-0.00303749999999965289; -0.00326272970909697842;
	-0.00360000000000052249; 0.00428577718226568|];
 500, [|0.000410264165390502753; -0.000462909647779479; 0.000647500000000000072;
	-0.0051511983154670718; -0.00652250000000000052;
	-0.000512794793261868|];
 1000, [|0.00105018568147014716; -0.000530692955589585; 0.00061625;
	 -0.00682083652373660556; -0.00605500000000000049;
	 -0.000289921516079636279|]]


let dock_robot_weights =
  [1, [|-574.163997476385; -833.677709551524231; 85.1851851851594;
	-82.0540170759377; -114.074074074047573; -534.682743404459416|];
   3, [|-448.178846936778427; -593.460403071947781; 83.1481481481106783;
	-40.2873248442569221; -98.5185185184961227; -418.878238711967526|];
   5, [|-397.265844491895166; -408.814503901135083; 56.2174444444360901;
	-44.821115171503159; -84.8833333333250408; -265.199664207834|];
   10, [|-354.790468711129; -331.199274963431947; 50.518481481465237;
	 -44.3255036067132; -96.4085185185312525; -238.861912846655684|];
   50, [|-279.507313002601393; -196.783739058288518; 23.9348666666697;
	   -33.299288488086539; -81.4512444444495; -135.657357030171539|];
   100, [|-259.075224221378; -149.900201658981189; 25.2986555555553174;
	  -44.5645018210282; -80.8143333333353411; -107.493735761047432|];
   500, [|-207.837008484431863; -109.075040088586064; -12.2396533333333295;
	  -17.7037225284834783; -62.3955288888913273; -70.4826022742913239|];
   1000, [|-191.34380542500142; -73.3815228006713; -0.167126666666654683;
	   -22.7588385440833427; -55.4602251851902253; -55.2400420189127601|]
  ]


let bst_weights_tiles =
  [5, [| -1692.402171; -734.783657; -1853.528914; 0.000000|];
   10, [|-3455.654400; -683.360229; -2628.308571; 0.000000;|];
   50, [|-11880.926074; -624.394697; -5166.397594; 0.000000;|];
   100, [|-18273.715303; -640.164549; -6596.483143; 0.000000;|];]


let vac_weights =
  [5, [|1.12652942529933873e-16; 0.000867775138558985891; 0.000895035460992911;
	-0.000158353127474333626; -0.000209929078014210626; 0.|];
   10, [|-2.46584003216211849e-15; 0.00100554235946143295; 0.00109290780141829517;
	 -0.000254948535232859836; 7.80141843594049417e-06;
	 -3.37689945450780937e-16|];
   50, [|-4.36258668079511141e-15; 9.42201108472554764e-05;
	 5.09219858156081235e-05; -0.000253206650834089653;
	 -0.000872340425531435487; 2.54588017334334352e-16|];
   100, [|-2.04419814409106929e-16; -8.78859857482212862e-06;
	  -2.23404255319147786e-05; -0.000326128266033275669;
	  -0.000207872340425472891; -1.34441069388202419e-18|];
   500, [|1.45022882591661063e-16; -2.72684085510689763e-05;
	  7.48936170212781729e-06; -0.000248076009501196882;
	  -0.000330978723404260812; -2.60208521396521055e-19|];
   1000, [|1.80411241501587944e-17; -2.22565320665081634e-05;
	   2.15106382978723404e-05; -0.000332992874109259149;
	   -0.000730808510638307788; 2.81892564846231162e-19|]]

let heavy_vac =
  [5, [|0.000750658358914604385; 0.000285047053986721313;
	-0.000720000000000093395; -0.00125246201390708705;
	-0.00192000000008889964; 0.000105069115258198107|];
   10, [|-0.000626027288327805236; 0.00105769708531690222;
	 -0.000720000000002984095; 9.46397161673637476e-05;
	 -0.00237333333331431673; 0.0005569815858336919|];
   50, [|-0.000832715221274891678; 0.0006693597273208984; 4.79999999951902364e-05;
	 -0.00125286448237864876; -0.00212800000039172496; 0.0011411869341890475|];
   100, [|-0.000107204185623529851; 0.000509520118481014564;
	  -0.00122400000000534386; -0.00189646274936840957; -0.00432800000052325183;
	  0.00079970585022872266|];
   500, [|-0.000531203827898353; -0.000512767094956134879; -0.00207199999999181867;
	  3.04877321163597725e-05; -0.00304799999891633639; 0.0013115814527563806|];
   1000,[|0.000220740542145936736; -0.000374362559443086; -0.00122399999996218155;
	  3.84366335557480483e-05; -0.00166159999733513477; 0.000978369207841313|]]


let get_weight_vector sface beam_width =
  List.assoc beam_width
    (match sface.Search_interface.domain with
       | Search_interface.UGrid -> unit_grid_weights
       | Search_interface.LGrid -> life_grid_weights
       | Search_interface.Tiles -> fifteen_puzzle_weights
       | Search_interface.Inv_tiles -> inv_15_puzzle
       | Search_interface.Dock_robot -> dock_robot_weights
       | Search_interface.Vacuum -> vac_weights
       | Search_interface.Heavy_vacuum -> heavy_vac
       | _ -> failwith "No Known weights for that domain!")


let get_inverted_vector sface beam_width =
  Array.map (fun e -> e *. (-1.))
    (List.assoc beam_width
       (match sface.Search_interface.domain with
	  | Search_interface.UGrid -> unit_grid_weights
	  | Search_interface.LGrid -> life_grid_weights
	  | Search_interface.Tiles -> fifteen_puzzle_weights
	  | Search_interface.Inv_tiles -> inv_15_puzzle
	  | Search_interface.Dock_robot -> dock_robot_weights
	  | Search_interface.Vacuum -> vac_weights
	  | Search_interface.Heavy_vacuum -> heavy_vac
	  | _ -> failwith "No Known weights for that domain!"))

(* EOF *)
