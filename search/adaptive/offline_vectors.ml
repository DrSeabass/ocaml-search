(* A place for weights learned offline via regression, experimentation,
   or intuition *)

let h_ind = 0
and d_ind = 1
and g_ind = 2
and depth_ind = 3
and h_rev = 4
and d_rev = 5

type models =
    M1
  | M2
  | M3
  | M4

type dom =
  | Unit4
  | Unit8
  | Life4
  | Life8


let m1regexp = Str.regexp_case_fold ".*M1.*"
and m2regexp = Str.regexp_case_fold ".*M2.*"
and m3regexp = Str.regexp_case_fold ".*M3.*"
and m4regexp = Str.regexp_case_fold ".*M4.*"


let string_to_model alg =
  if Str.string_match m1regexp alg 0
  then M1
  else
    (if Str.string_match m2regexp alg 0
     then M2
     else
       (if Str.string_match m3regexp alg 0
	then M3
	else
	  (if Str.string_match m4regexp alg 0
	   then M4
	   else failwith (Wrutils.str "%s does not contain a model" alg))))


let null_vect = [| 0.; 0.; 0.; 0.; 0.; 0.;|]
and basic_greedy = [| 1.; 0.; 0.; 0.; 0.; 0.;|]
and basic_speedy = [| 0.; 1.; 0.; 0.; 0.; 0.;|]
  (* learned weights from offline batch regression *)
and unit_4_35_model1 = [|
  [|0.284921; 0.;0.;0.; 0.; 0.;|];
  [|0.295266; 0.;0.;0.; 0.; 0.;|];
  [|0.296129; 0.;0.;0.; 0.; 0.;|];
  [|0.282213; 0.;0.;0.; 0.; 0.;|];
  [|0.293966; 0.;0.;0.; 0.; 0.;|];
  [|0.299227; 0.;0.;0.; 0.; 0.;|];
  [|0.294126; 0.;0.;0.; 0.; 0.;|];
  [|0.289835; 0.;0.;0.; 0.; 0.;|];
  [|0.286951; 0.;0.;0.; 0.; 0.;|];
  [|0.297655; 0.;0.;0.; 0.; 0.;|];
  [|0.286505; 0.;0.;0.; 0.; 0.;|];
  [|0.282621; 0.;0.;0.; 0.; 0.;|];
  [|0.292649; 0.;0.;0.; 0.; 0.;|];
  [|0.283993; 0.;0.;0.; 0.; 0.;|];
  [|0.282944; 0.;0.;0.; 0.; 0.;|];
  [|0.304950; 0.;0.;0.; 0.; 0.;|];
  [|0.292800; 0.;0.;0.; 0.; 0.;|];
  [|0.308578; 0.;0.;0.; 0.; 0.;|];
  [|0.287172; 0.;0.;0.; 0.; 0.;|];
  [|0.279107; 0.;0.;0.; 0.; 0.;|];|]
  (* make sure to check the order of these. *)
and unit_4_35_model2 = [|
  [|1498102270.135562;-1498102269.850507;0.;0.; 0.; 0.;|];
  [|-1644403620.264261;1644403620.559656;0.;0.; 0.; 0.;|];
  [|-2633279583.161339;2633279583.457123;0.;0.; 0.; 0.;|];
  [|-5102870.354285;5102870.636498;0.;0.; 0.; 0.;|];
  [|10062480322.857996;-10062480322.563900;0.;0.; 0.; 0.;|];
  [|662883114.711416;-662883114.412067;0.;0.; 0.; 0.;|];
  [|-63393679.351726;63393679.645866;0.;0.; 0.; 0.;|];
  [|436611656.093544;-436611655.803751;0.;0.; 0.; 0.;|];
  [|78202576.651460;-78202576.364503;0.;0.; 0.; 0.;|];
  [|16629318875.134895;-16629318874.837008;0.;0.; 0.; 0.;|];
  [|-67197498.185769;67197498.472278;0.;0.; 0.; 0.;|];
  [|1477825785.630465;-1477825785.348238;0.;0.; 0.; 0.;|];
  [|3138095773.447232;-3138095773.154414;0.;0.; 0.; 0.;|];
  [|130912212.036525;-130912211.752513;0.;0.; 0.; 0.;|];
  [|-108675913.390195;108675913.673156;0.;0.; 0.; 0.;|];
  [|2563611186.506183;-2563611186.201037;0.;0.; 0.; 0.;|];
  [|-2874709433.621688;2874709433.914499;0.;0.; 0.; 0.;|];
  [|2789428964.161373;-2789428963.852579;0.;0.; 0.; 0.;|];
  [|-758515935.129855;758515935.417149;0.;0.; 0.; 0.;|];
  [|10178793318.606562;-10178793318.327232;0.;0.; 0.; 0.;|];|]

and unit_4_35_model3 = [|
  [|966055078.964902;-966055078.664733;-0.024186;0.; 0.; 0.;|];
  [|-1123711987.487200;1123711987.794680;-0.020230;0.; 0.; 0.;|];
  [|-2444070868.366902;2444070868.673183;-0.017702;0.; 0.; 0.;|];
  [|343297300.017873;-343297299.724806;-0.017511;0.; 0.; 0.;|];
  [|6818972535.041739;-6818972534.734343;-0.021631;0.; 0.; 0.;|];
  [|417367362.986763;-417367362.673299;-0.022862;0.; 0.; 0.;|];
  [|241282046.662970;-241282046.355131;-0.022124;0.; 0.; 0.;|];
  [|837861664.270344;-837861663.972856;-0.012636;0.; 0.; 0.;|];
  [|-516625443.101587;516625443.397948;-0.015432;0.; 0.; 0.;|];
  [|15105512675.842020;-15105512675.529734;-0.022797;0.; 0.; 0.;|];
  [|692012028.851465;-692012028.555536;-0.015113;0.; 0.; 0.;|];
  [|1372485090.176613;-1372485089.882187;-0.020083;0.; 0.; 0.;|];
  [|2935510645.346595;-2935510645.046474;-0.011821;0.; 0.; 0.;|];
  [|-213621816.214025;213621816.508199;-0.016954;0.; 0.; 0.;|];
  [|146683165.934274;-146683165.643333;-0.013248;0.; 0.; 0.;|];
  [|2396164086.810085;-2396164086.495750;-0.014615;0.; 0.; 0.;|];
  [|14579552289.056875;-14579552288.751490;-0.020913;0.; 0.; 0.;|];
  [|2646227325.005501;-2646227324.689081;-0.012221;0.; 0.; 0.;|];
  [|-535907255.743442;535907256.041358;-0.017818;0.; 0.; 0.;|];
  [|9066059125.049587;-9066059124.753395;-0.027284;0.; 0.; 0.;|];|]

and unit_4_35_model4 = [|
  [|966055078.964902;-966055078.664733;-0.024186;0.000000; 0.; 0.;|];
  [|-1123711987.487200;1123711987.794680;-0.020230;0.000000; 0.; 0.;|];
  [|-2444070868.366902;2444070868.673183;-0.017702;0.000000; 0.; 0.;|];
  [|343297300.017873;-343297299.724806;-0.017511;0.000000; 0.; 0.;|];
  [|6818972535.041739;-6818972534.734343;-0.021631;0.000000; 0.; 0.;|];
  [|417367362.986763;-417367362.673299;-0.022862;0.000000; 0.; 0.;|];
  [|241282046.662970;-241282046.355131;-0.022124;0.000000; 0.; 0.;|];
  [|837861664.270344;-837861663.972856;-0.012636;0.000000; 0.; 0.;|];
  [|-516625443.101587;516625443.397948;-0.015432;0.000000; 0.; 0.;|];
  [|15105512675.842020;-15105512675.529734;-0.022797;0.000000; 0.; 0.;|];
  [|692012028.851465;-692012028.555536;-0.015113;0.000000; 0.; 0.;|];
  [|1372485090.176613;-1372485089.882187;-0.020083;0.000000; 0.; 0.;|];
  [|2935510645.346595;-2935510645.046474;-0.011821;0.000000; 0.; 0.;|];
  [|-213621816.214025;213621816.508199;-0.016954;0.000000; 0.; 0.;|];
  [|146683165.934274;-146683165.643333;-0.013248;0.000000; 0.; 0.;|];
  [|2396164086.810085;-2396164086.495750;-0.014615;0.000000; 0.; 0.;|];
  [|14579552289.056875;-14579552288.751490;-0.020913;0.000000; 0.; 0.;|];
  [|2646227325.005501;-2646227324.689081;-0.012221;0.000000; 0.; 0.;|];
  [|-535907255.743442;535907256.041358;-0.017818;0.000000; 0.; 0.;|];
  [|9066059125.049587;-9066059124.753395;-0.027284;0.000000; 0.; 0.;|];|]


and life_4_35_model1 = [|
  [|0.479634; 0.; 0.; 0.; 0.; 0.;|];
  [|0.479559; 0.; 0.; 0.; 0.; 0.;|];
  [|0.471203; 0.; 0.; 0.; 0.; 0.;|];
  [|0.492879; 0.; 0.; 0.; 0.; 0.;|];
  [|0.481957; 0.; 0.; 0.; 0.; 0.;|];
  [|0.490184; 0.; 0.; 0.; 0.; 0.;|];
  [|0.482714; 0.; 0.; 0.; 0.; 0.;|];
  [|0.443566; 0.; 0.; 0.; 0.; 0.;|];
  [|0.474856; 0.; 0.; 0.; 0.; 0.;|];
  [|0.420382; 0.; 0.; 0.; 0.; 0.;|];
  [|0.504640; 0.; 0.; 0.; 0.; 0.;|];
  [|0.476927; 0.; 0.; 0.; 0.; 0.;|];
  [|0.446060; 0.; 0.; 0.; 0.; 0.;|];
  [|0.484196; 0.; 0.; 0.; 0.; 0.;|];
  [|0.421618; 0.; 0.; 0.; 0.; 0.;|];
  [|0.474262; 0.; 0.; 0.; 0.; 0.;|];
  [|0.481637; 0.; 0.; 0.; 0.; 0.;|];
  [|0.467413; 0.; 0.; 0.; 0.; 0.;|];
  [|0.496420; 0.; 0.; 0.; 0.; 0.;|];
  [|0.506483; 0.; 0.; 0.; 0.; 0.;|];|]

and life_4_35_model2 = [|
  [|0.280385;62.810195; 0.; 0.; 0.; 0.;|];
  [|0.278603;63.294609; 0.; 0.; 0.; 0.;|];
  [|0.297802;54.521681; 0.; 0.; 0.; 0.;|];
  [|0.274125;69.304647; 0.; 0.; 0.; 0.;|];
  [|0.282349;62.963405; 0.; 0.; 0.; 0.;|];
  [|0.261286;72.224739; 0.; 0.; 0.; 0.;|];
  [|0.260973;69.861184; 0.; 0.; 0.; 0.;|];
  [|0.251819;60.031851; 0.; 0.; 0.; 0.;|];
  [|0.300315;54.901066; 0.; 0.; 0.; 0.;|];
  [|0.270383;46.804083; 0.; 0.; 0.; 0.;|];
  [|0.287927;68.598108; 0.; 0.; 0.; 0.;|];
  [|0.293073;57.902136; 0.; 0.; 0.; 0.;|];
  [|0.279795;52.017524; 0.; 0.; 0.; 0.;|];
  [|0.302980;57.025394; 0.; 0.; 0.; 0.;|];
  [|0.245508;54.890365; 0.; 0.; 0.; 0.;|];
  [|0.289513;58.209350; 0.; 0.; 0.; 0.;|];
  [|0.321123;50.492116; 0.; 0.; 0.; 0.;|];
  [|0.263229;64.283082; 0.; 0.; 0.; 0.;|];
  [|0.276665;69.385291; 0.; 0.; 0.; 0.;|];
  [|0.331663;55.288041; 0.; 0.; 0.; 0.;|];|]

and life_4_35_model3 = [|
  [|0.312488;58.468247;-0.015853; 0.; 0.; 0.;|];
  [|0.315628;58.256581;-0.018183; 0.; 0.; 0.;|];
  [|0.329755;50.200977;-0.015689; 0.; 0.; 0.;|];
  [|0.304374;65.142172;-0.014567; 0.; 0.; 0.;|];
  [|0.316784;58.247959;-0.016813; 0.; 0.; 0.;|];
  [|0.298527;67.069231;-0.017632; 0.; 0.; 0.;|];
  [|0.288965;66.015364;-0.013787; 0.; 0.; 0.;|];
  [|0.311168;52.252354;-0.030143; 0.; 0.; 0.;|];
  [|0.318628;52.459845;-0.009087; 0.; 0.; 0.;|];
  [|0.323562;39.933062;-0.026828; 0.; 0.; 0.;|];
  [|0.304111;66.353683;-0.007845; 0.; 0.; 0.;|];
  [|0.315280;54.893184;-0.010638; 0.; 0.; 0.;|];
  [|0.317130;47.180730;-0.018707; 0.; 0.; 0.;|];
  [|0.321848;54.419754;-0.009161; 0.; 0.; 0.;|];
  [|0.311539;46.561598;-0.032321; 0.; 0.; 0.;|];
  [|0.314742;54.822878;-0.012464; 0.; 0.; 0.;|];
  [|0.338831;48.107201;-0.008761; 0.; 0.; 0.;|];
  [|0.302077;59.104295;-0.019239; 0.; 0.; 0.;|];
  [|0.300843;66.103840;-0.011648; 0.; 0.; 0.;|];
  [|0.346354;53.249319;-0.007002; 0.; 0.; 0.;|];|]

and life_4_35_model4 = [|
  [|0.312488;58.468247;-0.015853;0.000000; 0.; 0.;|];
  [|0.315628;58.256581;-0.018183;0.000000; 0.; 0.;|];
  [|0.329755;50.200977;-0.015689;0.000000; 0.; 0.;|];
  [|0.304374;65.142172;-0.014567;0.000000; 0.; 0.;|];
  [|0.316784;58.247959;-0.016813;0.000000; 0.; 0.;|];
  [|0.298527;67.069231;-0.017632;0.000000; 0.; 0.;|];
  [|0.288965;66.015364;-0.013787;0.000000; 0.; 0.;|];
  [|0.311168;52.252354;-0.030143;0.000000; 0.; 0.;|];
  [|0.318628;52.459845;-0.009087;0.000000; 0.; 0.;|];
  [|0.323562;39.933062;-0.026828;0.000000; 0.; 0.;|];
  [|0.304111;66.353683;-0.007845;0.000000; 0.; 0.;|];
  [|0.315280;54.893184;-0.010638;0.000000; 0.; 0.;|];
  [|0.317130;47.180730;-0.018707;0.000000; 0.; 0.;|];
  [|0.321848;54.419754;-0.009161;0.000000; 0.; 0.;|];
  [|0.311539;46.561598;-0.032321;0.000000; 0.; 0.;|];
  [|0.314742;54.822878;-0.012464;0.000000; 0.; 0.;|];
  [|0.338831;48.107201;-0.008761;0.000000; 0.; 0.;|];
  [|0.302077;59.104295;-0.019239;0.000000; 0.; 0.;|];
  [|0.300843;66.103840;-0.011648;0.000000; 0.; 0.;|];
  [|0.346354;53.249319;-0.007002;0.000000; 0.; 0.;|];|]


and unit_8_45_model1 = [|
  [| 0.121327; 0.;0.;0.; 0.; 0.;|];
  [| 0.119850; 0.;0.;0.; 0.; 0.; |];
  [| 0.117497; 0.;0.;0.; 0.; 0.; |];
  [| 0.134836; 0.;0.;0.; 0.; 0.; |];
  [| 0.124424; 0.;0.;0.; 0.; 0.; |];
  [| 0.123179; 0.;0.;0.; 0.; 0.; |];
  [| 0.124351; 0.;0.;0.; 0.; 0.; |];
  [| 0.125629; 0.;0.;0.; 0.; 0.; |];
  [| 0.127688; 0.;0.;0.; 0.; 0.; |];
  [| 0.122042; 0.;0.;0.; 0.; 0.; |];
  [| 0.125471; 0.;0.;0.; 0.; 0.; |];
  [| 0.127772; 0.;0.;0.; 0.; 0.; |];
  [| 0.122572; 0.;0.;0.; 0.; 0.; |];
  [| 0.124103; 0.;0.;0.; 0.; 0.; |];
  [| 0.121685; 0.;0.;0.; 0.; 0.; |];
  [| 0.126866; 0.;0.;0.; 0.; 0.; |];
  [| 0.126972; 0.;0.;0.; 0.; 0.; |];
  [| 0.124555; 0.;0.;0.; 0.; 0.; |];
  [| 0.127694; 0.;0.;0.; 0.; 0.; |];
  [| 0.124115; 0.;0.;0.; 0.; 0.; |];|]
and unit_8_45_model2 = [|
  [| -0.710347;0.871127; 0.;0.;0.; 0.; |];
  [| -0.746977;0.908165; 0.;0.;0.; 0.; |];
  [| -0.716631;0.873226; 0.;0.;0.; 0.; |];
  [| -0.666866;0.841988; 0.;0.;0.; 0.; |];
  [| -0.777081;0.943826; 0.;0.;0.; 0.; |];
  [| -0.754253;0.918292; 0.;0.;0.; 0.; |];
  [| -0.677313;0.839806; 0.;0.;0.; 0.; |];
  [| -0.709902;0.874276; 0.;0.;0.; 0.; |];
  [| -0.669689;0.836133; 0.;0.;0.; 0.; |];
  [| -0.707482;0.869275; 0.;0.;0.; 0.; |];
  [| -0.723331;0.890486; 0.;0.;0.; 0.; |];
  [| -0.659234;0.824829; 0.;0.;0.; 0.; |];
  [| -0.730734;0.893545; 0.;0.;0.; 0.; |];
  [| -0.777296;0.943377; 0.;0.;0.; 0.; |];
  [| -0.803375;0.969006; 0.;0.;0.; 0.; |];
  [| -0.689253;0.855547; 0.;0.;0.; 0.; |];
  [| -0.670118;0.834327; 0.;0.;0.; 0.; |];
  [| -0.735950;0.901530; 0.;0.;0.; 0.; |];
  [| -0.674845;0.840165; 0.;0.;0.; 0.; |];
  [| -0.741565;0.907247; 0.;0.;0.; 0.; |];|]
and unit_8_45_model3 = [|
  [| -0.764027;0.923606;0.006621; 0.;0.;0.; |];
  [| -0.774230;0.934791;0.003398; 0.;0.;0.; |];
  [| -0.732171;0.888375;0.001989; 0.;0.;0.; |];
  [| -0.758566;0.932091;0.010658; 0.;0.;0.; |];
  [| -0.793701;0.960014;0.002147; 0.;0.;0.; |];
  [| -0.784413;0.947747;0.003767; 0.;0.;0.; |];
  [| -0.695683;0.857653;0.002498; 0.;0.;0.; |];
  [| -0.736485;0.900126;0.003475; 0.;0.;0.; |];
  [| -0.740194;0.905197;0.008386; 0.;0.;0.; |];
  [| -0.729004;0.890277;0.002747; 0.;0.;0.; |];
  [| -0.767923;0.934035;0.005666; 0.;0.;0.; |];
  [| -0.728043;0.892269;0.008201; 0.;0.;0.; |];
  [| -0.770774;0.932803;0.004680; 0.;0.;0.; |];
  [| -0.807465;0.972891;0.003640; 0.;0.;0.; |];
  [| -0.859739;1.024318;0.006534; 0.;0.;0.; |];
  [| -0.761140;0.926020;0.008578; 0.;0.;0.; |];
  [| -0.731893;0.894854;0.007283; 0.;0.;0.; |];
  [| -0.784788;0.949334;0.005927; 0.;0.;0.; |];
  [| -0.734408;0.898469;0.007212; 0.;0.;0.; |];
  [| -0.783446;0.948219;0.005152; 0.;0.;0.; |];|]
and unit_8_45_model4 = [|
  [| -0.764027;0.923606;0.006621;0.000000; 0.;0.; |];
  [| -0.774230;0.934791;0.003398;0.000000; 0.;0.; |];
  [| -0.732171;0.888375;0.001989;0.000000; 0.;0.; |];
  [| -0.758566;0.932091;0.010658;0.000000; 0.;0.; |];
  [| -0.793701;0.960014;0.002147;0.000000; 0.;0.; |];
  [| -0.784413;0.947747;0.003767;0.000000; 0.;0.; |];
  [| -0.695683;0.857653;0.002498;0.000000; 0.;0.; |];
  [| -0.736485;0.900126;0.003475;0.000000; 0.;0.; |];
  [| -0.740194;0.905197;0.008386;0.000000; 0.;0.; |];
  [| -0.729004;0.890277;0.002747;0.000000; 0.;0.; |];
  [| -0.767923;0.934035;0.005666;0.000000; 0.;0.; |];
  [| -0.728043;0.892269;0.008201;0.000000; 0.;0.; |];
  [| -0.770774;0.932803;0.004680;0.000000; 0.;0.; |];
  [| -0.807465;0.972891;0.003640;0.000000; 0.;0.; |];
  [| -0.859739;1.024318;0.006534;0.000000; 0.;0.; |];
  [| -0.761140;0.926020;0.008578;0.000000; 0.;0.; |];
  [| -0.731893;0.894854;0.007283;0.000000; 0.;0.; |];
  [| -0.784788;0.949334;0.005927;0.000000; 0.;0.; |];
  [| -0.734408;0.898469;0.007212;0.000000; 0.;0.; |];
  [| -0.783446;0.948219;0.005152;0.000000; 0.;0.; |];|]



and life_8_45_model1 = [|
  [| 0.228188; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.240000; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.224200; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.224326; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.228773; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.221633; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.230672; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.222690; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.223679; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.220870; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.234299; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.226777; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.223449; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.224860; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.226426; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.225769; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.230506; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.238187; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.245696; 0.; 0.; 0.; 0.; 0.; |];
  [| 0.225407; 0.; 0.; 0.; 0.; 0.; |];|]
and life_8_45_model2 = [|
  [| 0.413836;-111.366093; 0.; 0.; 0.; 0.; |];
  [| 0.428128;-113.104563; 0.; 0.; 0.; 0.; |];
  [| 0.418856;-116.747304; 0.; 0.; 0.; 0.; |];
  [| 0.404632;-108.110288; 0.; 0.; 0.; 0.; |];
  [| 0.418543;-113.876319; 0.; 0.; 0.; 0.; |];
  [| 0.401814;-107.959318; 0.; 0.; 0.; 0.; |];
  [| 0.416224;-111.393358; 0.; 0.; 0.; 0.; |];
  [| 0.411128;-112.907264; 0.; 0.; 0.; 0.; |];
  [| 0.412945;-113.244864; 0.; 0.; 0.; 0.; |];
  [| 0.408139;-112.203178; 0.; 0.; 0.; 0.; |];
  [| 0.421698;-112.457699; 0.; 0.; 0.; 0.; |];
  [| 0.415150;-112.919247; 0.; 0.; 0.; 0.; |];
  [| 0.402729;-107.453445; 0.; 0.; 0.; 0.; |];
  [| 0.412383;-112.444795; 0.; 0.; 0.; 0.; |];
  [| 0.411587;-111.062133; 0.; 0.; 0.; 0.; |];
  [| 0.416642;-114.374922; 0.; 0.; 0.; 0.; |];
  [| 0.420927;-114.305387; 0.; 0.; 0.; 0.; |];
  [| 0.425998;-112.857861; 0.; 0.; 0.; 0.; |];
  [| 0.431907;-112.033594; 0.; 0.; 0.; 0.; |];
  [| 0.406973;-108.846914; 0.; 0.; 0.; 0.; |];|]
and life_8_45_model3 = [|
  [| 0.353697;-95.953594;0.033868; 0.; 0.; 0.; |];
  [| 0.362909;-96.305099;0.036993; 0.; 0.; 0.; |];
  [| 0.354747;-100.513773;0.036481; 0.; 0.; 0.; |];
  [| 0.350427;-94.156452;0.030594; 0.; 0.; 0.; |];
  [| 0.355726;-97.793435;0.035785; 0.; 0.; 0.; |];
  [| 0.347901;-94.182466;0.030679; 0.; 0.; 0.; |];
  [| 0.357280;-96.359750;0.033409; 0.; 0.; 0.; |];
  [| 0.351705;-97.631705;0.033628; 0.; 0.; 0.; |];
  [| 0.350006;-96.894948;0.035229; 0.; 0.; 0.; |];
  [| 0.350789;-97.572666;0.032699; 0.; 0.; 0.; |];
  [| 0.360053;-96.506212;0.034748; 0.; 0.; 0.; |];
  [| 0.355329;-97.523555;0.033787; 0.; 0.; 0.; |];
  [| 0.348355;-93.434155;0.030858; 0.; 0.; 0.; |];
  [| 0.352551;-97.028867;0.033745; 0.; 0.; 0.; |];
  [| 0.353682;-96.351114;0.032678; 0.; 0.; 0.; |];
  [| 0.355419;-98.700449;0.034690; 0.; 0.; 0.; |];
  [| 0.359229;-98.434310;0.035075; 0.; 0.; 0.; |];
  [| 0.360986;-96.031298;0.036870; 0.; 0.; 0.; |];
  [| 0.366648;-95.123048;0.036834; 0.; 0.; 0.; |];
  [| 0.349566;-94.059757;0.032488; 0.; 0.; 0.; |];|]
and life_8_45_model4 = [|
  [| 0.353697;-95.953594;0.033868;0.000000; 0.; 0.; |];
  [| 0.362909;-96.305099;0.036993;0.000000; 0.; 0.; |];
  [| 0.354747;-100.513773;0.036481;0.000000; 0.; 0.; |];
  [| 0.350427;-94.156452;0.030594;0.000000; 0.; 0.; |];
  [| 0.355726;-97.793435;0.035785;0.000000; 0.; 0.; |];
  [| 0.347901;-94.182466;0.030679;0.000000; 0.; 0.; |];
  [| 0.357280;-96.359750;0.033409;0.000000; 0.; 0.; |];
  [| 0.351705;-97.631705;0.033628;0.000000; 0.; 0.; |];
  [| 0.350006;-96.894948;0.035229;0.000000; 0.; 0.; |];
  [| 0.350789;-97.572666;0.032699;0.000000; 0.; 0.; |];
  [| 0.360053;-96.506212;0.034748;0.000000; 0.; 0.; |];
  [| 0.355329;-97.523555;0.033787;0.000000; 0.; 0.; |];
  [| 0.348355;-93.434155;0.030858;0.000000; 0.; 0.; |];
  [| 0.352551;-97.028867;0.033745;0.000000; 0.; 0.; |];
  [| 0.353682;-96.351114;0.032678;0.000000; 0.; 0.; |];
  [| 0.355419;-98.700449;0.034690;0.000000; 0.; 0.; |];
  [| 0.359229;-98.434310;0.035075;0.000000; 0.; 0.; |];
  [| 0.360986;-96.031298;0.036870;0.000000; 0.; 0.; |];
  [| 0.366648;-95.123048;0.036834;0.000000; 0.; 0.; |];
  [| 0.349566;-94.059757;0.032488;0.000000; 0.; 0.; |];|]


let do_avg ars =
  let to_ret = Array.create (Array.length (List.hd ars)) 0.
  and tot = float_of_int (List.length ars) in
    List.iter (fun a ->
		 for i = 0 to (Array.length a) - 1
		 do
		   to_ret.(i) <- to_ret.(i) +. a.(i) /. tot
		 done) ars;
    to_ret



(* Need to add some checking of problem size in later *)
let get_model m d =
  match m with
    | M1 -> (match d with
	       | Unit4 -> unit_4_35_model1
	       | Unit8 -> unit_8_45_model1
	       | Life4 -> life_4_35_model1
	       | Life8 -> life_8_45_model1)
    | M2 -> (match d with
	       | Unit4 -> unit_4_35_model2
	       | Unit8 -> unit_8_45_model2
	       | Life4 -> life_4_35_model2
	       | Life8 -> life_8_45_model2)
    | M3 -> (match d with
	       | Unit4 -> unit_4_35_model3
	       | Unit8 -> unit_8_45_model3
	       | Life4 -> life_4_35_model3
	       | Life8 -> life_8_45_model3)
    | M4 -> (match d with
	       | Unit4 -> unit_4_35_model4
	       | Unit8 -> unit_8_45_model4
	       | Life4 -> life_4_35_model4
	       | Life8 -> life_8_45_model4)

let get_exact_vect width height instance dom model =
  (*Verb.pe Verb.debug "Loading vect for instance %i\n%!" instance;*)
  (get_model model dom).(instance - 1)


let get_rand_vect _ _ _  dom model =
  (get_model model dom).(Random.int (Array.length (get_model model dom)))


let get_avg_vect width height _ dom model =
 do_avg (Array.to_list (get_model model dom))


let get_bs_vect width height instance dom model =
 do_avg (Array.to_list (Array.sub (get_model model dom) 0 instance))


let blasted_lands_150_1 =
  [|0.261290;-0.315215;0.011965;0.000000|]

let game_vector _ _ = blasted_lands_150_1



(* EOF *)
